--- a/src/x3dna/algorithms/base_frame_calculator.cpp
+++ b/src/x3dna/algorithms/base_frame_calculator.cpp
@@ -60,13 +60,20 @@ RmsdCheckResult check_nt_type_by_rmsd(const core::Residue& residue) {
     bool has_c1_prime = false;
     int purine_atom_count = 0; // Count of purine atoms found (N7, C8, N9)
 
+    // Get residue name for hardcoded atom lookup  
+    std::string res_name = residue.name();
+    while (!res_name.empty() && res_name[0] == ' ')
+        res_name.erase(0, 1);
+    while (!res_name.empty() && res_name.back() == ' ')
+        res_name.pop_back();
+
 #ifdef DEBUG_FRAME_CALC
-    std::string res_name = residue.name();
-    while (!res_name.empty() && res_name[0] == ' ')
-        res_name.erase(0, 1);
-    while (!res_name.empty() && res_name.back() == ' ')
-        res_name.pop_back();
     bool is_cvc = (res_name == "CVC" && residue.chain_id() == 'B' && residue.seq_num() == 7);
+#endif
+
+    // Check for hardcoded atom list (for modified nucleotides)
+    auto hardcoded_atoms = TemplateAssignment::get_matching_atoms(res_name);
+    
+#ifdef DEBUG_FRAME_CALC
     if (is_cvc) {
         std::cerr << "DEBUG: check_nt_type_by_rmsd for CVC B7, residue has " << residue.num_atoms()
                   << " atoms\n";
@@ -74,9 +81,18 @@ RmsdCheckResult check_nt_type_by_rmsd(const core::Residue& residue) {
 #endif
 
     // Try to match ALL ring atoms (like legacy does)
-    for (size_t i = 0; i < RING_ATOM_NAMES.size(); ++i) {
-        const char* atom_name = RING_ATOM_NAMES[i];
+    // OR use hardcoded atom list if specified
+    const size_t num_atoms = hardcoded_atoms.has_value() ? hardcoded_atoms.value().size() : 9;
+    
+    for (size_t i = 0; i < num_atoms; ++i) {
+        std::string atom_name_str;
+        if (hardcoded_atoms.has_value()) {
+            atom_name_str = hardcoded_atoms.value()[i];
+        } else {
+            atom_name_str = std::string(RING_ATOM_NAMES[i]);
+        }
 
+        const std::string& atom_name = atom_name_str;
         // Find this atom in residue
         for (const auto& atom : residue.atoms()) {
             if (atom.name() == atom_name) {
@@ -84,18 +100,27 @@ RmsdCheckResult check_nt_type_by_rmsd(const core::Residue& residue) {
                 experimental_coords.push_back(geometry::Vector3D(pos.x(), pos.y(), pos.z()));
 
                 // Find matching index in RING_ATOM_NAMES for standard geometry
                 size_t std_idx = i; // Default
                 for (size_t j = 0; j < 9; ++j) {
                     if (std::string(RING_ATOM_NAMES[j]) == atom_name) {
                         std_idx = j;
                         break;
                     }
                 }
 
                 // Use corresponding standard geometry
                 standard_coords.push_back(geometry::Vector3D(STANDARD_RING_GEOMETRY[std_idx][0],
                                                              STANDARD_RING_GEOMETRY[std_idx][1],
                                                              STANDARD_RING_GEOMETRY[std_idx][2]));
 
                 // Count nitrogen atoms (indices 1=N3, 3=N1, 6=N7, 8=N9)
                 if (std_idx == 1 || std_idx == 3 || std_idx == 6 || std_idx == 8) {
                     nN++;
                 }
@@ -161,12 +186,19 @@ RmsdCheckResult check_nt_type_by_rmsd(const core::Residue& residue) {
     // Collect matched atom names in the order they were found
     // This matches the order in experimental_coords and standard_coords
     std::vector<std::string> matched_names;
-    for (size_t i = 0; i < RING_ATOM_NAMES.size(); ++i) {
-        const char* atom_name = RING_ATOM_NAMES[i];
+    
+    // Use hardcoded list if available
+    auto hardcoded_for_names = TemplateAssignment::get_matching_atoms(res_name);
+    const size_t num_names = hardcoded_for_names.has_value() ? hardcoded_for_names.value().size() : 9;
+    
+    for (size_t i = 0; i < num_names; ++i) {
+        std::string atom_name_check = hardcoded_for_names.has_value() ? 
+            hardcoded_for_names.value()[i] : std::string(RING_ATOM_NAMES[i]);
+        
         // Check if this atom was found in residue (same logic as above)
         for (const auto& atom : residue.atoms()) {
-            if (atom.name() == atom_name) {
-                matched_names.push_back(std::string(atom_name));
+            if (atom.name() == atom_name_check) {
+                matched_names.push_back(atom_name_check);
                 break;
             }
         }

